{% extends 'base.html' %}

{% block title %}Register{% endblock %}

{% block header %}Hotel Reservation System{% endblock %}

{% block content %}
<div class="form-container">
    <h2>Register an Account</h2>
    <form id="register-form">
        <input type="text" name="name" placeholder="Full Name" required>
        <input type="email" name="email" placeholder="Email Address" required>
        <input type="password" name="password" placeholder="Password" required>
        <input type="submit" value="Register">
        <div id="register-error" class="error-message"></div>
    </form>
    <p>Already have an account? <a href="{{ url_for('routes.login') }}">Login here</a>.</p>
</div>

<script>
    document.getElementById('register-form').addEventListener('submit', function(e) {
        e.preventDefault();
        var formData = new FormData(this);

        fetch('{{ url_for("routes.register") }}', {
            method: 'POST',
            body: formData
        }).then(response => response.json())
          .then(data => {
              if (data.success) {
                  window.location.href = data.redirect;
              } else {
                  var errorDiv = document.getElementById('register-error');
                  errorDiv.innerText = data.message;
                  errorDiv.style.display = 'block';  // Show error message
              }
          })
          .catch(error => {
              console.error('Error:', error);
              var errorDiv = document.getElementById('register-error');
              errorDiv.innerText = 'An unexpected error occurred. Please try again.';
              errorDiv.style.display = 'block';  // Show error message
          });
    });
</script>
{% endblock %}
